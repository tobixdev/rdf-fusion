---
source: bench/tests/plans/bsbm_business_intelligence.rs
expression: canonicalize_uuids(&string)
---
ProjectionExec: expr=[ENV_PT(vendor@0) as vendor, ENV_PT(cheapExpensiveRatio@3) as cheapExpensiveRatio]
  SortExec: TopK(fetch=10), expr=[ENV_SORT(DIV(xsd:float(belowAvg@1), offerCount@2)) DESC, ENV_SORT(ENV_PT(vendor@0)) ASC], preserve_partitioning=[false]
    ProjectionExec: expr=[vendor@0 as vendor, belowAvg@1 as belowAvg, offerCount@2 as offerCount, DIV(xsd:float(belowAvg@1), offerCount@2) as cheapExpensiveRatio]
      CoalesceBatchesExec: target_batch_size=8192
        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(vendor@0, vendor@0)], projection=[vendor@0, belowAvg@1, offerCount@3]
          ProjectionExec: expr=[vendor@0 as vendor, enc_int64_as_rdf_term(00000000000000000000000000000001@1) as belowAvg]
            AggregateExec: mode=Single, gby=[vendor@1 as vendor], aggr=[00000000000000000000000000000001]
              CoalesceBatchesExec: target_batch_size=8192
                HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(product@0, product@2)], projection=[offer@1, vendor@2]
                  QuadPatternExec: n_graphs=1, subject=?product, predicate=<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>, object=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType4>
                  CoalesceBatchesExec: target_batch_size=8192
                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(offer@0, offer@0)], projection=[offer@0, vendor@1, product@3]
                      QuadPatternExec: n_graphs=1, subject=?offer, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/vendor>, object=?vendor
                      CoalesceBatchesExec: target_batch_size=8192
                        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(offer@0, offer@0)], filter=EBV(LT(xsd:float(xsd:boolean(ENC_TV(price@0))), avgPrice@1)), projection=[offer@0, product@3]
                          QuadPatternExec: n_graphs=1, subject=?offer, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/price>, object=?price
                          CoalesceBatchesExec: target_batch_size=8192
                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(product@1, product@0)], projection=[offer@0, product@1, avgPrice@3]
                              QuadPatternExec: n_graphs=1, subject=?offer, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/product>, object=?product
                              ProjectionExec: expr=[product@0 as product, 00000000000000000000000000000002@1 as avgPrice]
                                AggregateExec: mode=Single, gby=[product@0 as product], aggr=[00000000000000000000000000000002]
                                  CoalesceBatchesExec: target_batch_size=8192
                                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(product@0, product@0)], projection=[product@0, price@2]
                                      QuadPatternExec: n_graphs=1, subject=?product, predicate=<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>, object=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType4>
                                      CoalesceBatchesExec: target_batch_size=8192
                                        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(offer@0, offer@0)], projection=[product@1, price@3]
                                          QuadPatternExec: n_graphs=1, subject=?offer, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/product>, object=?product
                                          CoalesceBatchesExec: target_batch_size=8192
                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(offer@0, offer@0)], projection=[offer@0, price@2]
                                              ProjectionExec: expr=[offer@0 as offer]
                                                QuadPatternExec: n_graphs=1, subject=?offer, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/vendor>, object=?vendor
                                              QuadPatternExec: n_graphs=1, subject=?offer, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/price>, object=?price
          ProjectionExec: expr=[vendor@0 as vendor, enc_int64_as_rdf_term(00000000000000000000000000000003@1) as offerCount]
            AggregateExec: mode=Single, gby=[vendor@1 as vendor], aggr=[00000000000000000000000000000003]
              CoalesceBatchesExec: target_batch_size=8192
                HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(product@0, product@1)], projection=[offer@1, vendor@3]
                  QuadPatternExec: n_graphs=1, subject=?product, predicate=<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>, object=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType4>
                  CoalesceBatchesExec: target_batch_size=8192
                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(offer@0, offer@0)], projection=[offer@0, product@1, vendor@3]
                      QuadPatternExec: n_graphs=1, subject=?offer, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/product>, object=?product
                      QuadPatternExec: n_graphs=1, subject=?offer, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/vendor>, object=?vendor
