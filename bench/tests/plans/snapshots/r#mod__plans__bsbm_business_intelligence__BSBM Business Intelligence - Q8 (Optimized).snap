---
source: bench/tests/plans/bsbm_business_intelligence.rs
expression: canonicalize_uuids(&explanation.optimized_logical_plan.to_string())
---
Projection: ENV_PT(vendor) AS vendor, ENV_PT(cheapExpensiveRatio) AS cheapExpensiveRatio
  Sort: ENV_SORT(DIV(xsd:float(belowAvg), offerCount)) DESC NULLS FIRST, ENV_SORT(ENV_PT(vendor)) ASC NULLS FIRST, fetch=10
    Projection: vendor, belowAvg, offerCount, DIV(xsd:float(belowAvg), offerCount) AS cheapExpensiveRatio
      Projection: lhs.vendor AS vendor, lhs.belowAvg AS belowAvg, rhs.offerCount AS offerCount
        Inner Join: lhs.vendor = rhs.vendor
          SubqueryAlias: lhs
            Projection: vendor, enc_int64_as_rdf_term(00000000000000000000000000000001) AS belowAvg
              Aggregate: groupBy=[[vendor AS vendor]], aggr=[[count(offer) AS 00000000000000000000000000000001]]
                Projection: rhs.offer AS offer, rhs.vendor AS vendor
                  Inner Join: lhs.product = rhs.product
                    SubqueryAlias: lhs
                      QuadPattern (?product <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType4>), active_graph: Union of [DefaultGraph] 
                    SubqueryAlias: rhs
                      Projection: lhs.offer AS offer, rhs.vendor AS vendor, rhs.product AS product
                        Inner Join: lhs.offer = rhs.offer Filter: EBV(LT(xsd:float(xsd:boolean(ENC_TV(lhs.price))), rhs.avgPrice))
                          SubqueryAlias: lhs
                            QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/price> ?price), active_graph: Union of [DefaultGraph] 
                          SubqueryAlias: rhs
                            Projection: lhs.offer AS offer, lhs.vendor AS vendor, rhs.product AS product, rhs.avgPrice AS avgPrice
                              Inner Join: lhs.offer = rhs.offer
                                SubqueryAlias: lhs
                                  QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/vendor> ?vendor), active_graph: Union of [DefaultGraph] 
                                SubqueryAlias: rhs
                                  Projection: lhs.offer AS offer, lhs.product AS product, rhs.avgPrice AS avgPrice
                                    Inner Join: lhs.product = rhs.product
                                      SubqueryAlias: lhs
                                        QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/product> ?product), active_graph: Union of [DefaultGraph] 
                                      SubqueryAlias: rhs
                                        Projection: product, 00000000000000000000000000000002 AS avgPrice
                                          Aggregate: groupBy=[[product AS product]], aggr=[[AVG(xsd:float(xsd:boolean(ENC_TV(price)))) AS 00000000000000000000000000000002]]
                                            Projection: lhs.product AS product, rhs.price AS price
                                              Inner Join: lhs.product = rhs.product
                                                SubqueryAlias: lhs
                                                  QuadPattern (?product <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType4>), active_graph: Union of [DefaultGraph] 
                                                SubqueryAlias: rhs
                                                  Projection: rhs.product AS product, rhs.price AS price
                                                    Inner Join: lhs.offer = rhs.offer
                                                      SubqueryAlias: lhs
                                                        Projection: offer
                                                          QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/vendor> ?vendor), active_graph: Union of [DefaultGraph] 
                                                      SubqueryAlias: rhs
                                                        Projection: lhs.offer AS offer, lhs.product AS product, rhs.price AS price
                                                          Inner Join: lhs.offer = rhs.offer
                                                            SubqueryAlias: lhs
                                                              QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/product> ?product), active_graph: Union of [DefaultGraph] 
                                                            SubqueryAlias: rhs
                                                              QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/price> ?price), active_graph: Union of [DefaultGraph] 
          SubqueryAlias: rhs
            Projection: vendor, enc_int64_as_rdf_term(00000000000000000000000000000003) AS offerCount
              Aggregate: groupBy=[[vendor AS vendor]], aggr=[[count(offer) AS 00000000000000000000000000000003]]
                Projection: rhs.offer AS offer, rhs.vendor AS vendor
                  Inner Join: lhs.product = rhs.product
                    SubqueryAlias: lhs
                      QuadPattern (?product <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType4>), active_graph: Union of [DefaultGraph] 
                    SubqueryAlias: rhs
                      Projection: lhs.offer AS offer, lhs.product AS product, rhs.vendor AS vendor
                        Inner Join: lhs.offer = rhs.offer
                          SubqueryAlias: lhs
                            QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/product> ?product), active_graph: Union of [DefaultGraph] 
                          SubqueryAlias: rhs
                            QuadPattern (?offer <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/vendor> ?vendor), active_graph: Union of [DefaultGraph]
