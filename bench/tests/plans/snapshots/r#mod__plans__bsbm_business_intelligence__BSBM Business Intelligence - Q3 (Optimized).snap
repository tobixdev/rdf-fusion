---
source: bench/tests/plans/bsbm_business_intelligence.rs
expression: canonicalize_uuids(&explanation.optimized_logical_plan.to_string())
---
Projection: ENV_PT(product) AS product, ENV_PT(ratio) AS ratio
  Sort: ENV_SORT(DIV(xsd:float(monthCount), monthBeforeCount)) DESC NULLS FIRST, ENV_SORT(ENV_PT(product)) ASC NULLS FIRST, fetch=10
    Projection: product, monthCount, monthBeforeCount, DIV(xsd:float(monthCount), monthBeforeCount) AS ratio
      Projection: lhs.product AS product, lhs.monthCount AS monthCount, rhs.monthBeforeCount AS monthBeforeCount
        Inner Join: lhs.product = rhs.product
          SubqueryAlias: lhs
            Projection: product, enc_int64_as_rdf_term(00000000000000000000000000000001) AS monthCount
              Aggregate: groupBy=[[product AS product]], aggr=[[count(review) AS 00000000000000000000000000000001]]
                Projection: lhs.review AS review, lhs.product AS product
                  Inner Join: lhs.review = rhs.review
                    SubqueryAlias: lhs
                      QuadPattern (?review <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/reviewFor> ?product), active_graph: Union of [DefaultGraph] 
                    SubqueryAlias: rhs
                      Projection: review
                        Filter: coalesce(EBV(GEQ(ENC_TV(date), Union 12:{value:6332757120000.0000000000000000,offset:})), Boolean(false)) AND coalesce(EBV(LT(ENC_TV(date), Union 12:{value:6332999040000.0000000000000000,offset:})), Boolean(false))
                          QuadPattern (?review <http://purl.org/dc/elements/1.1/date> ?date), active_graph: Union of [DefaultGraph] 
          SubqueryAlias: rhs
            Projection: product, enc_int64_as_rdf_term(00000000000000000000000000000002) AS monthBeforeCount
              Filter: EBV(GT(enc_int64_as_rdf_term(00000000000000000000000000000002), Union 9:0))
                Aggregate: groupBy=[[product AS product]], aggr=[[count(review) AS 00000000000000000000000000000002]]
                  Projection: lhs.review AS review, lhs.product AS product
                    Inner Join: lhs.review = rhs.review
                      SubqueryAlias: lhs
                        QuadPattern (?review <http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/reviewFor> ?product), active_graph: Union of [DefaultGraph] 
                      SubqueryAlias: rhs
                        Projection: review
                          Filter: coalesce(EBV(GEQ(ENC_TV(date), Union 12:{value:6332515200000.0000000000000000,offset:})), Boolean(false)) AND coalesce(EBV(LT(ENC_TV(date), Union 12:{value:6332757120000.0000000000000000,offset:})), Boolean(false))
                            QuadPattern (?review <http://purl.org/dc/elements/1.1/date> ?date), active_graph: Union of [DefaultGraph]
