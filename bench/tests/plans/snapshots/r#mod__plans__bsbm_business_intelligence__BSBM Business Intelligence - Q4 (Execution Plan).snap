---
source: bench/tests/plans/bsbm_business_intelligence.rs
expression: canonicalize_uuids(&string)
---
ProjectionExec: expr=[ENV_PT(feature@0) as feature, ENV_PT(priceRatio@3) as priceRatio]
  SortExec: TopK(fetch=10), expr=[ENV_SORT(DIV(withFeaturePrice@1, withoutFeaturePrice@2)) DESC, ENV_SORT(ENV_PT(feature@0)) ASC], preserve_partitioning=[false]
    ProjectionExec: expr=[feature@0 as feature, withFeaturePrice@1 as withFeaturePrice, withoutFeaturePrice@2 as withoutFeaturePrice, DIV(withFeaturePrice@1, withoutFeaturePrice@2) as priceRatio]
      CoalesceBatchesExec: target_batch_size=8192
        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(feature@0, feature@0)], projection=[feature@0, withFeaturePrice@1, withoutFeaturePrice@3]
          ProjectionExec: expr=[feature@0 as feature, 00000000000000000000000000000001@1 as withFeaturePrice]
            AggregateExec: mode=Single, gby=[feature@0 as feature], aggr=[00000000000000000000000000000001]
              CoalesceBatchesExec: target_batch_size=8192
                HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(product@0, product@0)], projection=[feature@2, price@3]
                  QuadPatternExec: n_graphs=1, subject=?product, predicate=<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>, object=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType48>
                  CoalesceBatchesExec: target_batch_size=8192
                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(product@0, product@0)], projection=[product@0, feature@1, price@3]
                      QuadPatternExec: n_graphs=1, subject=?product, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/productFeature>, object=?feature
                      CoalesceBatchesExec: target_batch_size=8192
                        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(offer@0, offer@0)], projection=[product@1, price@3]
                          QuadPatternExec: n_graphs=1, subject=?offer, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/product>, object=?product
                          QuadPatternExec: n_graphs=1, subject=?offer, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/price>, object=?price
          ProjectionExec: expr=[feature@0 as feature, 00000000000000000000000000000002@1 as withoutFeaturePrice]
            AggregateExec: mode=Single, gby=[feature@0 as feature], aggr=[00000000000000000000000000000002]
              CoalesceBatchesExec: target_batch_size=8192
                HashJoinExec: mode=CollectLeft, join_type=LeftAnti, on=[(feature@0, __inner__feature@1), (product@1, __inner__product@0)], projection=[feature@0, price@2]
                  CrossJoinExec
                    ProjectionExec: expr=[first_value(feature) ORDER BY [feature ASC NULLS FIRST]@1 as feature]
                      AggregateExec: mode=Single, gby=[feature@0 as feature], aggr=[first_value(feature) ORDER BY [feature ASC NULLS FIRST]]
                        CoalesceBatchesExec: target_batch_size=8192
                          HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(p@0, p@0)], projection=[feature@2]
                            QuadPatternExec: n_graphs=1, subject=?p, predicate=<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>, object=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType48>
                            QuadPatternExec: n_graphs=1, subject=?p, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/productFeature>, object=?feature
                    CoalesceBatchesExec: target_batch_size=8192
                      HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(product@0, product@0)], projection=[product@0, price@2]
                        QuadPatternExec: n_graphs=1, subject=?product, predicate=<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>, object=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/instances/ProductType48>
                        CoalesceBatchesExec: target_batch_size=8192
                          HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(offer@0, offer@0)], projection=[product@1, price@3]
                            QuadPatternExec: n_graphs=1, subject=?offer, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/product>, object=?product
                            QuadPatternExec: n_graphs=1, subject=?offer, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/price>, object=?price
                  ProjectionExec: expr=[product@0 as __inner__product, feature@1 as __inner__feature]
                    QuadPatternExec: n_graphs=1, subject=?product, predicate=<http://www4.wiwiss.fu-berlin.de/bizer/bsbm/v01/vocabulary/productFeature>, object=?feature
